<ion-content [fullscreen]="true">
  <!-- Botón de atrás en la esquina superior izquierda -->
  <div class="back-button-container">
    <ion-button fill="clear" color="dark" (click)="goBack()" class="back-button">
      <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
    </ion-button>
  </div>
  <div class="join-room-container">
    <div class="content">
      <h1 class="title">SALAS DISPONIBLES</h1>
      
      <div class="search-container">
        <ion-item class="search-item">
          <ion-input 
            [(ngModel)]="searchTerm" 
            placeholder="Buscar sala..."
            (ionInput)="onSearchChange($event)">
            <ion-icon name="search" slot="start"></ion-icon>
          </ion-input>
        </ion-item>
      </div>

      <div class="rooms-container">
        <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>

        <div *ngIf="isLoading" class="loading-container">
          <ion-spinner name="crescent"></ion-spinner>
          <p>Cargando salas...</p>
        </div>

        <div *ngIf="!isLoading && filteredRooms.length === 0" class="no-rooms-container">
          <ion-icon name="chatbubbles-outline"></ion-icon>
          <p>No hay salas disponibles</p>
          <ion-button fill="clear" (click)="loadRooms()">Recargar</ion-button>
        </div>

        <ion-list *ngIf="!isLoading && filteredRooms.length > 0" class="rooms-list">
          <ion-item 
            *ngFor="let room of filteredRooms" 
            class="room-item"
            (click)="joinRoom(room.id)">
            <div class="room-info">
              <h2 class="room-name">{{ room.name }}</h2>
              <p class="room-details">
                {{ room.current_players || 0 }}/{{ room.max_players }} jugadores • 
                {{ room.num_teams }} equipos
              </p>
              <p class="room-status" [class.waiting]="room.status === 'waiting'">
                {{ getStatusText(room.status) }}
              </p>
            </div>
            <ion-icon name="chevron-forward" slot="end"></ion-icon>
          </ion-item>
        </ion-list>
      </div>

      <div class="refresh-button-container">
        <ion-button 
          fill="clear" 
          (click)="loadRooms()" 
          [disabled]="isLoading">
          <ion-icon name="refresh" slot="start"></ion-icon>
          Recargar salas
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>