<ion-content [fullscreen]="true">
  <!-- Bot√≥n de atr√°s en la esquina superior izquierda -->
  <div class="back-button-container">
    <ion-button fill="clear" color="dark" (click)="goBack()" class="back-button">
      <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
    </ion-button>
  </div>
  <div class="join-room-container">
    <div class="content">
      <h1 class="title">PARTIDAS</h1>
      
      <div class="search-container">
        <ion-item class="search-item">
          <ion-input 
            id="searchTerm"
            name="searchTerm"
            [(ngModel)]="searchTerm" 
            placeholder="Buscar partida..."
            (ionInput)="onSearchChange($event)">
            <ion-icon name="search" slot="start"></ion-icon>
          </ion-input>
        </ion-item>
      </div>

      <div class="rooms-container">
        <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
          <ion-refresher-content></ion-refresher-content>
        </ion-refresher>

        <div *ngIf="isLoading" class="loading-container">
          <ion-spinner name="crescent"></ion-spinner>
          <p>Cargando partidas...</p>
        </div>

        <!-- Mis Salas (donde soy anfitri√≥n) -->
        <div *ngIf="!isLoading && filteredMyRooms.length > 0" class="section">
          <h2 class="section-title">üè† Mis partidas</h2>
          <ion-list class="rooms-list">
            <ion-item 
              *ngFor="let room of filteredMyRooms" 
              class="room-item my-room"
              (click)="joinRoom(room.id)">
              <div class="room-info">
                <h3 class="room-name">{{ room.name }}</h3>
                <p class="room-details">
                  {{ room.current_players || 0 }}/{{ room.max_players }} jugadores ‚Ä¢ 
                  {{ room.num_teams }} equipos
                </p>
                <p class="room-status" [class.waiting]="room.status === 'waiting'">
                  {{ getStatusText(room.status) }} ‚Ä¢ Anfitri√≥n
                </p>
              </div>
              <ion-icon name="chevron-forward" slot="end"></ion-icon>
            </ion-item>
          </ion-list>
        </div>

        <!-- Salas Disponibles -->
        <div *ngIf="!isLoading" class="section">
          <div *ngIf="filteredAvailableRooms.length === 0" class="no-rooms-container">
            <ion-icon name="chatbubbles-outline"></ion-icon>
            <p>No hay partidas disponibles</p>
            <ion-button fill="clear" (click)="loadRooms()">Recargar</ion-button>
          </div>

          <ion-list *ngIf="filteredAvailableRooms.length > 0" class="rooms-list">
            <ion-item 
              *ngFor="let room of filteredAvailableRooms" 
              class="room-item"
              (click)="joinRoom(room.id)">
              <div class="room-info">
                <h3 class="room-name">{{ room.name }}</h3>
                <p class="room-details">
                  {{ room.current_players || 0 }}/{{ room.max_players }} jugadores ‚Ä¢ 
                  {{ room.num_teams }} equipos
                </p>
                <p class="room-status" [class.waiting]="room.status === 'waiting'">
                  {{ getStatusText(room.status) }}
                </p>
              </div>
              <ion-icon name="chevron-forward" slot="end"></ion-icon>
            </ion-item>
          </ion-list>
        </div>
      </div>

      <!-- Nickname guardado -->
      <div *ngIf="savedNickname" class="saved-nickname">
        <p>üéÆ Nickname guardado: <strong>{{ savedNickname }}</strong></p>
      </div>
    </div>
  </div>
</ion-content>